"""
ç°¡å–®çš„ä½¿ç”¨ç¯„ä¾‹
å±•ç¤ºå¦‚ä½•ä½¿ç”¨è‡ªå‹•è£½ä½œæ‰“å­—ç·´ç¿’è¡¨ç¨‹å¼
"""

import xlwings as xw

from a710_è£½ä½œæ‰“å­—ç·´ç¿’å·¥ä½œè¡¨ import create_typing_practice_sheet


def demo_usage():
    """
    å±•ç¤ºä½¿ç”¨æ–¹æ³•
    """
    print("=== è‡ªå‹•è£½ä½œæ‰“å­—ç·´ç¿’è¡¨ - ä½¿ç”¨ç¯„ä¾‹ ===")
    print()
    print("1. è«‹ç¢ºä¿ Excel å·²é–‹å•Ÿï¼Œä¸”åŒ…å«ã€æ¼¢å­—æ³¨éŸ³ã€‘å·¥ä½œè¡¨")
    print("2. ç¢ºèªã€æ¼¢å­—æ³¨éŸ³ã€‘å·¥ä½œè¡¨çš„æ ¼å¼æ­£ç¢º")
    print("3. æº–å‚™åŸ·è¡Œç¨‹å¼...")
    print()

    try:
        # æª¢æŸ¥æ˜¯å¦æœ‰ä½œç”¨ä¸­çš„ Excel æ´»é ç°¿
        wb = xw.books.active
        print(f"âœ“ æ‰¾åˆ°ä½œç”¨ä¸­æ´»é ç°¿: {wb.name}")

        # æª¢æŸ¥æ˜¯å¦æœ‰ã€æ¼¢å­—æ³¨éŸ³ã€‘å·¥ä½œè¡¨
        if 'æ¼¢å­—æ³¨éŸ³' in [sheet.name for sheet in wb.sheets]:
            print("âœ“ æ‰¾åˆ°ã€æ¼¢å­—æ³¨éŸ³ã€‘å·¥ä½œè¡¨")

            # åŸ·è¡Œè£½ä½œæ‰“å­—ç·´ç¿’è¡¨
            print("\né–‹å§‹è£½ä½œæ‰“å­—ç·´ç¿’è¡¨...")
            success = create_typing_practice_sheet()

            if success:
                print("\nğŸ‰ æ‰“å­—ç·´ç¿’è¡¨è£½ä½œå®Œæˆï¼")
                print("è«‹æŸ¥çœ‹ã€æ‰“å­—ç·´ç¿’è¡¨ã€‘å·¥ä½œè¡¨")
            else:
                print("\nâŒ æ‰“å­—ç·´ç¿’è¡¨è£½ä½œå¤±æ•—")
        else:
            print("âŒ æ‰¾ä¸åˆ°ã€æ¼¢å­—æ³¨éŸ³ã€‘å·¥ä½œè¡¨")
            print("   å¯ç”¨çš„å·¥ä½œè¡¨:", [sheet.name for sheet in wb.sheets])

    except Exception as e:
        print(f"âŒ ç™¼ç”ŸéŒ¯èª¤: {e}")
        print("\nè«‹ç¢ºèª:")
        print("- Excel å·²é–‹å•Ÿ")
        print("- æœ‰ä½œç”¨ä¸­çš„æ´»é ç°¿")
        print("- æ´»é ç°¿ä¸­åŒ…å«ã€æ¼¢å­—æ³¨éŸ³ã€‘å·¥ä½œè¡¨")


if __name__ == "__main__":
    demo_usage()