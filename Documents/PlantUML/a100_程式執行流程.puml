@startuml
start
:初始化;
:載入環境變數;
:設置日誌;
:嘗試獲取活躍的 Excel 活頁簿;
if (找到活頁簿?) then (是)
    :檢查 V3 的輸入;
    if (V3 為空?) then (是)
        :記錄警告並終止;
        stop
    else (否)
        :清除儲存格內容;
        :重設儲存格格式;
        :從 V3 填入字元;
        :設置字元格式;
        :根據選定的類型查找標音;
        if (查找成功?) then (是)
            :儲存 Excel 檔案;
            :記錄儲存路徑;
        else (否)
            :記錄錯誤並終止;
            stop
        endif
    endif
else (否)
    :記錄錯誤並終止;
    stop
endif
:結束;
stop
@enduml
