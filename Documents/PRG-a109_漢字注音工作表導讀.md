# a109_漢字注音工作表導讀

## 需求摘要

用途：提供 <-- 及 --> （向前/向後）按鍵，以利操作者在誦讀【漢字注音】工作表時，
可利用【作用儲存格】十字交叉的聚焦游標，導引觀眾目光的移動，使逐字的漢字發音誦讀，
更顯有趣。另外，操作者無需借助滑鼠指標，僅需使用【←】或【→】按鍵，便能在上/下行
移動。譬如：在【第2行】的行尾（即儲存格：R9）時，按【→】鍵，游標會跳到【第3行】
的行首（即儲存格：D13）。

## 規格說明

1. 行號與【漢字儲存格】的對映關係如下：

    - 【第1行】的儲存格：D5, E5, F5,... ,R5；
    - 【第2行】的儲存格：D9, E9, F9,... ,R9；
    - 【第3行】的儲存格：D13, E13, F13,... ,R13；

2. 程式開始執行時，【作用儲存格】落於【漢字注音】工作表的第1行行首儲存格（即：D5）。

3. 操作鍵只提供【←】及【→】兩個方向鍵，分別用以控制游標向前或向後移動。

4. 當【作用儲存格】游標位於某行的行首儲存格（如：D9、D13...）時，按【←】鍵，游標會跳到前一行（如：D5、D9...）

    - 連續按【向左】/【向右】鍵快速移動，不會被換行符號打斷
    - 停留在換行符號位置超過 0.5 秒後，會自動跳到下一行
    - 當作用儲存格停在【行尾】（R9），且【下一行】（D13）的【行首】為【換行】時...，按【向右】方向鍵：
          R9 → 按【→】鍵 → 移動到 D13 → 等待 0.5 秒 → 自動跳到 D17
    - 接續上述情境，作用儲存格落在 D17 位置，按【向左】方向鍵兩次，因而回到 R9 儲存格：
      R9 → 按【→】鍵 → 移動到 D13 → 立即按【←】鍵 → 回到 R9
                                      ↑
                            重置計時器，取消自動跳過


5. 當【作用儲存格】游標位於某行的行尾儲存格（如：R5、R9...）時，按【→】鍵，
  游標會跳到下一行（如：D9、D13...）

6. 按【Esc】鍵，可結束本程式的執行。

7. 按【Ctrl+C】鍵，可中斷本程式的執行。

8. 按【空白】/【Q】鍵，可查詢【萌台語字典】。（a220_作用儲存格查找萌典漢字讀音.py）

9. 按【S】鍵，可查詢【個人字典】。 （a222_依作用儲存格在個人字典查找漢字讀音.py）

10. 使用【向上】/【向下】鍵在不同行之間移動

    - 【向上】鍵：移動到上一行的相同欄位：
      D13 → 按【↓】鍵 → 移動到 D17（下一行相同欄位）
    - 【向下】鍵：移動到下一行的相同欄位：
      D17 → 按【↑】鍵 → 移動到 D13（上一行相同欄位）

## 導讀模式

1. 新增兩個樣式管理函數（第 336-393 行）

### hide_manual_annotation_style(wb)

- 將【人工標音儲存格】樣式的字型顏色改為象牙白（與填滿顏色相同）
- 使用 Excel COM API 修改樣式：style.Font.Color = 0xF0FFFF
- BGR 格式：240, 255, 255（象牙白）

### restore_manual_annotation_style(wb)

- 將【人工標音儲存格】樣式的字型顏色改回紅色
- 使用 Excel COM API 修改樣式：style.Font.Color = 0x0000FF
- BGR 格式：0, 0, 255（紅色）

2. 整合到主程式流程

進入導讀模式前（第 912 行）：

```python
# 隱藏人工標音文字
hide_manual_annotation_style(wb)
```

程式結束前（第 939 行）：

```python
# 恢復人工標音文字顏色
restore_manual_annotation_style(wb)
```

異常處理（第 949-951 行）：

- 發生錯誤時也會嘗試恢復樣式，確保不會遺漏

3. 執行流程

程式啟動
  ↓
顯示操作說明
  ↓
【隱藏人工標音】字型顏色改為象牙白
  ↓
切換到 Excel 視窗
  ↓
進入導讀模式（視覺乾淨清爽）
  ↓
使用者按 ESC 鍵
  ↓
【恢復人工標音】字型顏色改回紅色
  ↓
程式結束

### 人工標音儲存格處理細節

✅ 進入導讀模式後，紅色的人工標音文字會「隱藏」（變成象牙白）
✅ 視覺更清爽，不會眼花撩亂
✅ 按 ESC 結束後，自動恢復紅色，方便後續校正作業

