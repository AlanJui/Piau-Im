flowchart TD
    A[[開始]] --> B[設定作用工作表]
    B --> C[讀取參數與範圍]
    C --> D[初始化 EOF False 與 line 1]
    D --> E{外層迴圈 條件成立}
    E -->|是| F[列群初始化 與 選取列首]
    E -->|否| Z[[結束]]

    F --> G[進入內層迴圈 處理各欄位]
    G --> H{收到換行 或 EOF}
    H -->|是| I[跳出內層]
    H -->|否| G

    I --> J{EOF 為真 或 line 大於總列數}
    J -->|是| Z
    J -->|否| K{是否到列尾}
    K -->|是| L[輸出空白行]
    K -->|否| M[不輸出空白行]
    L --> N[line 加一]
    M --> N[line 加一]
    N --> E
