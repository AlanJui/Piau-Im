# 【漢字注音】工作表重置

## 【漢字注音】工作表

參考如下【附表1】可知：
在【漢字注音】工作表，每 1 漢字標音【行】，使用 Excel 工作表中的 4 列（Row） 。

- (row 1)【人工標音】儲存格位址：欄位址同【漢字】；【列位址】-- 3, 7, 11, 15, ...
- (row 2)【台語音標】儲存格位址：欄位址同【漢字】；【列位址】-- 4, 8, 12, 16, ...
- (row 3)【漢字】儲存格位址：在於【欄位址】--【D欄】（欄號：4）至【R欄】（欄號：18）；【列位址】-- 5, 9, 13 , 17, ...列。
- (row 4)【漢字標音】儲存格位址：欄位址同【漢字】；【列位址】-- 6, 10, 14, 18, ...

【舉例】：

- 第 1 行之【人工標音】位置：row 3
- 第 1 行之【台語音標】位置：row 4
- 第 1 行之【漢字】位置：   row 5
- 第 1 行之【漢字標音】位置：row 6

- 第 2 行之【人工標音】位置：row 3
- 第 2 行之【台語音標】位置：row 4
- 第 2 行之【漢字】位置：   row 5
- 第 2 行之【漢字標音】位置：row 6


綜合上述可知，只要得【漢字】之【儲存格位址】，便能依轉換後的【座標位址】，找到【漢字】的【台語音標】、【漢字標音】及【人工標音】。

例如：漢字【春】置於【5D】儲存格位址，則可推算出【座標位址】為：（5, 4）。

- 求【人工標音】座標 = (5 - 2, 4)
- 求【台語音標】座標 = (5 - 1, 4)
- 求【漢字標音】座標 = (5 + 1, 4)

每個【漢字】相關的【台語音標】、【漢字標音】、【人工標音】各儲存格，其【功用】說明如下：

- 台語音標：本系統會以程式，自【漢字標音】資料庫查詢【漢字】之【台羅音標】；經程式轉換成【台語音標】然後填入。
- 人工標音：當【漢字標音】資料尚未登錄某漢字之【台羂音標】，使用者可人工手動，以【台語音標】填入於此。
- 漢字標音：因【河洛話】的標音系統諸多：十五音、白話字（POJ）、閩拼方案（BP）、台語音標（TLPA）、台羅音標（TL）...，系統可依使用者之設定，以程式自動轉換其慣用之【標音系統】，然後儲放於此儲存格。

【附表1】：【漢字注音】工作表格式

```md
| 2 | 3 | 4    | 5      | 6     | 7    | 8     | 9 | 10   | 11   | 12    | 13   | 14    | 15 | 16 | 17 | 18 |
|---|---|------|--------|-------|------|-------|---|------|------|-------|------|-------|----|----|----|----|
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      | cun1   | hiau2 |      |       |   |      |      |       |      |       |    |    |    |    |
| 1 |   | 《    | 春      | 曉     | 》    |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      | cun1   | hiao3 |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
| 2 |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   | cun1 | bian5  | put4  | kak4 | hiau2 |   | cu2  | cu2  | bun5  | the5 | ziau2 |    |    |    |    |
| 3 |   | 春    | 眠      | 不     | 覺    | 曉     | ， | 處    | 處    | 聞     | 啼    | 鳥     | 。  |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   | cun1 | bbian2 | but7  | gak7 | hiao3 |   | cu3  | cu3  | bbun2 | te2  | ziao3 |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
| 4 |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   | ia7  | lai5   | hong1 | u2   | sing1 |   | hua1 | lok8 | ti1   | to1  | siau2 |    |    |    |    |
| 5 |   | 夜    | 來      | 風     | 雨    | 聲     | ， | 花    | 落    | 知     | 多    | 少     | ？  | φ  |    |    |
|   |   | ia6  | lai2   | hong1 | u3   | sing1 |   | hua1 | lok8 | di1   | do1  | siao3 |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
|   |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
| 6 |   |      |        |       |      |       |   |      |      |       |      |       |    |    |    |    |
---


對於【每行】中各列 Excel 儲存格之格式有如下要求：：

- 行之 row 1 （人工標音）：

    - 儲存格底色：白色（或稱【無填滿】）
    - 文字顏色：紅色
    - 文字字型：Arial
    - 字型大小：24

- 行之 row 2 （台語音標）：

    - 儲存格底色：白色（或稱【無填滿】）
    - 文字顏色：RGB(255, 153, 51) = #FF9933
    - 文字字型：Sitka Text Semibold
    - 字型大小：24

- 行之 row 3 （漢字）：

    - 儲存格底色：白色（或稱【無填滿】）
    - 文字顏色：黑色（或稱【自動】）
    - 文字字型：吳守禮細明台語注音
    - 字型大小：48

- 行之 row 4 （漢字標音）：

    - 儲存格底色：白色（或稱【無填滿】）
    - 文字顏色：RGG(0, 153, 0) = #009900
    - 文字字型：芫荽 0.94
    - 字型大小：26

## 需求規格

每當我需要重置（reset）【漢字注音】工作表，使用到儲存格之底色、字型顏色、大小...均需設定，
且儲存格已填入之內容均清除。

Excel 在儲存格之處理，允許以【區域】為單位進行，使用者只需提供【左上角位址】與【右下角位址】，
便能執行如：清資料、設字型、...等工作。

【重置漢字注音工作表】之程式碼，為求高效，希望最好不要進行儲存格逐一重設；而是使用上述以【區域】
為目標之作業方式。

```python
 sheet.range('D3:R10').clear_contents()
```

整張【漢字注音】工作表，其工作區用於漢字標音之【總行數】，可自【env】工作表之【每頁總列數】名稱取得，如：

```python
    total_lines = wb.names['每頁總列數'].refers_to_range.value
    ROWS_PER_LINE = 4
    total_rows = total_lines * ROWS_PER_LINE
```

工作區使用之儲存格總數、左上方座標、右下方座標可依下列方式求得：

```python
    # 設定起始及結束的【列】位址（【第5列】、【第9列】、【第13列】等列）
    TOTAL_LINES = int(wb.names['每頁總列數'].refers_to_range.value)
    ROWS_PER_LINE = 4
    start_row = 5
    end_row = start_row + (TOTAL_LINES * ROWS_PER_LINE)

    # 設定起始及結束的【欄】位址（【D欄=4】到【R欄=18】）
    CHARS_PER_ROW = int(wb.names['每列總字數'].refers_to_range.value)
    start_col = 4
    end_col = start_col + CHARS_PER_ROW
```