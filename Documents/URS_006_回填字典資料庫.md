# URS_006 回填字典資料庫

將【缺字表】工作表中的【漢字】及【台語音標】回填 SQLite 資料庫。


## 規格

 - 资料庫系統： SQLite3 + SQLiteStudio v3.4.4
 - 資料庫名稱： Ho_Lok_Ue.db
 - 資料表名稱： 漢字庫
 - 程式語言： Python
 - Excel 套件： xlwings
 - 音標轉換：在 Excel 工作表中的【羅馬拼音字母】為【台語音標】，在寫入 SQLite 資料庫前，需轉換成【台羅音標】。

| 台語音標 | 校正音標 |
|--------|:--------|
| z      | ts      |
| c      | tsh     |

- 【正】： [ zian1 ] ==>  [tsian1 ]
- 【持】： [ ci5]  ==> [ tshi5 ]

### 【資料庫】資料結構

```sql
CREATE TABLE 漢字庫 (
    識別號  INTEGER NOT NULL
                 UNIQUE,
    漢字   TEXT,
    台羅音標 TEXT,
    常用度  REAL,
    摘要說明 TEXT,
    建立時間 TEXT    DEFAULT (DATETIME('now', 'localtime') )
                 NOT NULL,
    更新時間 TEXT    NOT NULL
                 DEFAULT (DATETIME('now', 'localtime') ),
    PRIMARY KEY (
        識別號 AUTOINCREMENT
    )
);
```

## 功能 1： 使用【缺字表】更新【漢字】資料庫

使用【缺字表】工作表的【漢字】、【台語音標】欄位資料，更新 SQLite 資料庫的【漢字庫】資料表（Table）。

- 漢字庫資料表。漢字 = 缺字表工作表。漢字
- 漢字庫資料表。台羅音標 = 缺字表工作表。台語音標

### 【缺字表】工作表欄位說明

- A 欄：漢字
- B 欄：總數
- C 欄：台語音標
- D 欄：校正音標
- E 欄：座標

### 【缺字表】工作表範例

| **漢字** | **總數** | **台語音標** | **校正音標** | **座標**          |
|:-------:|:-------:|:---------|:---------|:-----------------------|
|  **銜** | 1      | ham5       | N/A      | \(29, 18\)             |
|  **暉** | 1      | hui1       | N/A      | \(37, 7\)              |
|  **霪** | 1      | im5        | N/A      | \(61, 6\)              |
|  **檣** | 1      | ciong5     | N/A      | \(69, 11\)             |
|  **讒** | 1      | cam5       | N/A      | \(77, 9\)              |
|  **汀** | 1      | thing1     | N/A      | \(97, 8\)              |
|  **郁** | 2      | hiok4      | N/A      | \(97, 11\); \(97, 12\) |
|  **噫** | 1      | i1         | N/A      | \(145, 8\)             |

## 功能 2： 使用【標音字庫】更新【漢字】資料庫

使用【標音字庫】工作表的【漢字】、【校正音標】欄位資料，更新 SQLite 資料庫的【漢字庫】資料表（Table）。

- 漢字庫資料表。漢字 = 標音字庫工作表。漢字
- 漢字庫資料表。台羅音標 = 標音字庫工作表。校正音標

【限制條件】：

- 若【標音字庫】工作表的【校正音標】儲存格其值為："N/A" ，則略過，不寫入資料庫；
- 須【標音字庫】工作表的【校正音標】儲存格值不為 "N/A" ，才將【校正音標】欄位之值寫入資料庫的【台語音標】。

### 【標音字庫】工作表欄位說明

- A 欄：漢字
- B 欄：總數
- C 欄：台語音標
- D 欄：校正音標
- E 欄：座標

### 【標音字庫】工作表範例

| 漢字 | 總數 | 台語音標    | 校正音標  | 座標                                                      |
|----|----|---------|-------|---------------------------------------------------------|
| 余  | 1  | u5      | N/A   | (5, 4)                                                  |
| 少  | 2  | siau2   | N/A   | (5, 5); (21, 12)                                        |
| 能  | 1  | ling5   | N/A   | (5, 6)                                                  |
| 視  | 1  | si7     | N/A   | (5, 7)                                                  |
| 鬼  | 1  | kui2    | N/A   | (5, 8)                                                  |
| 嘗  | 1  | siong5  | N/A   | (5, 10)                                                 |
| 於  | 4  | u1      | N/A   | (5, 11); (25, 6); (49, 14); (85, 12)                    |
| 雪  | 2  | suat4   | N/A   | (5, 12); (17, 12)                                       |
| 夜  | 1  | ia7     | N/A   | (5, 13)                                                 |
| 野  | 1  | ia2     | N/A   | (5, 14)                                                 |
| 寺  | 1  | si7     | N/A   | (5, 15)                                                 |
| 逢  | 1  | hong5   | N/A   | (5, 16)                                                 |
| 一  | 5  | it4     | N/A   | (5, 17); (9, 15); (37, 10); (69, 10); (85, 6)           |
| 提  | 1  | the5    | N/A   | (5, 18)                                                 |
| 傀  | 4  | ka1     | khui2 | (9, 4); (25, 9); (37, 11); (65, 12)                     |
| 儡  | 4  | lo2     | lui2  | (9, 5); (25, 10); (37, 12); (65, 13)                    |
| 翁  | 5  | ang1    | ong1  | (9, 6); (21, 7); (45, 4); (57, 18); (97, 4)             |
| 鶴  | 1  | hoh8    | N/A   | (9, 8)                                                  |
| 髮  | 1  | huat4   | N/A   | (9, 9)                                                  |
| 襤  | 1  | lam5    | N/A   | (9, 10)                                                 |
| 褸  | 1  | lu2     | N/A   | (9, 11)                                                 |
| 唯  | 2  | ui5     | N/A   | (9, 13); (37, 9)                                        |
| 持  | 2  | ci5     | N/A   | (9, 14); (61, 5)                                        |
| 木  | 5  | bak8    | N/A   | (9, 16); (37, 13); (53, 12); (61, 6); (77, 12)          |
| 偶  | 6  | ngoo2   | N/A   | (9, 17); (37, 14); (53, 13); (61, 7); (73, 8); (77, 13) |
| 製  | 1  | ze3     | N/A   | (9, 18)                                                 |
| 作  | 3  | zok4    | N/A   | (13, 4); (49, 8); (61, 10)                              |
| 極  | 1  | kik8    | N/A   | (13, 5)                                                 |
| 精  | 1  | zing1   | N/A   | (13, 6)                                                 |
| 宛  | 2  | uan2    | N/A   | (13, 8); (81, 18)                                       |
| 如  | 2  | ju5     | N/A   | (13, 9); (69, 16)                                       |
| 嬌  | 1  | kiau1   | N/A   | (13, 10)                                                |
| 女  | 1  | lu2     | N/A   | (13, 11)                                                |
| 繪  | 3  | hue7    | N/A   | (13, 13); (57, 6); (81, 14)                             |
| 珠  | 1  | zu1     | N/A   | (13, 14)                                                |
| 淚  | 2  | lui7    | N/A   | (13, 15); (81, 16)                                      |
| 盈  | 1  | ing5    | N/A   | (13, 16)                                                |
| 睫  | 1  | ziap4   | ziat8 | (13, 17)                                                |
| 惹  | 1  | jia2    | N/A   | (17, 4)                                                 |
| 人  | 4  | jin5    | N/A   | (17, 5); (17, 16); (29, 17); (81, 12)                   |
| 見  | 2  | kian3   | N/A   | (17, 6); (77, 9)                                        |
| 憐  | 1  | lian5   | N/A   | (17, 7)                                                 |
| 時  | 2  | si5     | N/A   | (17, 9); (21, 13)                                       |
| 雲  | 1  | hun5    | N/A   | (17, 10)                                                |
| 彤  | 1  | tong5   | N/A   | (17, 11)                                                |
| 狂  | 1  | kong5   | N/A   | (17, 13)                                                |
| 二  | 1  | ji7     | N/A   | (17, 15)                                                |
| 比  | 1  | pi2     | N/A   | (17, 17)                                                |
| 肩  | 1  | kian1   | N/A   | (17, 18)                                                |
| 向  | 1  | hiong3  | N/A   | (21, 4)                                                 |
| 火  | 4  | hoonn2  | honn2 | (21, 5); (73, 10); (77, 10); (85, 16)                   |
| 自  | 2  | zu7     | N/A   | (21, 8); (29, 18)                                       |
| 述  | 1  | sut8    | N/A   | (21, 9)                                                 |
| 曰  | 3  | uat8    | N/A   | (21, 10); (65, 4); (97, 13)                             |
| 好  | 1  | ho2     | N/A   | (21, 14)                                                |
| 觀  | 1  | kuan1   | N/A   | (21, 15)                                                |
| 牽  | 2  | khian1  | N/A   | (21, 16); (49, 9)                                       |
| 絲  | 2  | si1     | N/A   | (21, 17); (49, 10)                                      |
| 戲  | 1  | hi3     | N/A   | (21, 18)                                                |
| 耽  | 1  | tann5   | N/A   | (25, 5)                                                 |
| 盤  | 2  | puann5  | N/A   | (25, 7); (49, 4)                                        |
| 鈴  | 2  | ling5   | N/A   | (25, 8); (49, 5)                                        |
| 之  | 4  | zi1     | N/A   | (25, 11); (45, 14); (53, 4); (65, 15)                   |
| 技  | 1  | ki1     | N/A   | (25, 12)                                                |
| 既  | 1  | ki3     | N/A   | (25, 14)                                                |
| 年  | 1  | lian5   | N/A   | (25, 15)                                                |
| 長  | 1  | tiong5  | N/A   | (25, 16)                                                |
| 其  | 3  | ki5     | N/A   | (25, 18); (33, 5); (45, 17)                             |
| 志  | 1  | zi3     | N/A   | (29, 4)                                                 |
| 愈  | 1  | ju2     | N/A   | (29, 5)                                                 |
| 堅  | 1  | kian1   | N/A   | (29, 6)                                                 |
| 遂  | 2  | sui7    | N/A   | (29, 8); (73, 4)                                        |
| 以  | 2  | i2      | N/A   | (29, 9); (29, 14)                                       |
| 此  | 2  | cu2     | N/A   | (29, 10); (69, 13)                                      |
| 為  | 1  | ui5     | N/A   | (29, 11)                                                |
| 業  | 1  | giap8   | N/A   | (29, 12)                                                |
| 物  | 1  | but8    | N/A   | (29, 15)                                                |
| 象  | 1  | siong7  | N/A   | (29, 16)                                                |
| 得  | 1  | tik4    | N/A   | (33, 4)                                                 |
| 樂  | 2  | ngau7   | gak8  | (33, 6); (49, 6)                                        |
| 奈  | 1  | ta1     | nai7  | (33, 8)                                                 |
| 何  | 1  | ho5     | N/A   | (33, 9)                                                 |
| 漂  | 1  | phiau1  | N/A   | (33, 10)                                                |
| 泊  | 1  | pok8    | N/A   | (33, 11)                                                |
| 終  | 2  | ziong1  | N/A   | (33, 12); (57, 16)                                      |
| 生  | 3  | sing1   | N/A   | (33, 13); (65, 7); (81, 11)                             |
| 居  | 1  | ki1     | N/A   | (33, 15)                                                |
| 無  | 2  | bu5     | N/A   | (33, 16); (37, 4)                                       |
| 所  | 2  | soo2    | N/A   | (33, 17); (37, 7)                                       |
| 行  | 1  | hang5   | hing5 | (33, 18)                                                |
| 侶  | 1  | li7     | N/A   | (37, 5)                                                 |
| 伴  | 1  | phuann7 | N/A   | (37, 8)                                                 |
| 且  | 2  | ciann2  | zoo1  | (45, 5); (45, 7)                                        |
| 言  | 2  | gian5   | N/A   | (45, 6); (45, 12)                                       |
| 泣  | 1  | khip4   | N/A   | (45, 8)                                                 |
| 餘  | 1  | u5      | N/A   | (45, 10)                                                |
| 溫  | 1  | un1     | N/A   | (45, 11)                                                |
| 釋  | 1  | sik4    | N/A   | (45, 13)                                                |
| 懇  | 1  | khun2   | N/A   | (45, 16)                                                |
| 奏  | 1  | zau3    | N/A   | (45, 18)                                                |
| 演  | 1  | ian2    | N/A   | (49, 12)                                                |
| 劇  | 1  | kiak8   | kiok8 | (49, 13)                                                |
| 三  | 1  | sam1    | N/A   | (49, 15)                                                |
| 尺  | 1  | cioh4   | cik4  | (49, 16)                                                |
| 紅  | 1  | ang5    | hong5 | (49, 17)                                                |
| 綿  | 1  | bian5   | N/A   | (49, 18)                                                |
| 上  | 1  | siong7  | N/A   | (53, 5)                                                 |
| 度  | 1  | too7    | N/A   | (53, 7)                                                 |
| 曲  | 2  | khiok4  | N/A   | (53, 8); (57, 15)                                       |
| 咿  | 1  | i1      | N/A   | (53, 9)                                                 |
| 嚶  | 1  | enn1    | ing1  | (53, 10)                                                |
| 顧  | 1  | koo3    | N/A   | (53, 14)                                                |
| 盼  | 1  | phan3   | N/A   | (53, 15)                                                |
| 神  | 1  | sin5    | N/A   | (53, 16)                                                |
| 飛  | 1  | hui1    | N/A   | (53, 17)                                                |
| 雖  | 1  | sui1    | N/A   | (57, 4)                                                 |
| 妝  | 1  | zong1   | N/A   | (57, 5)                                                 |
| 悲  | 1  | pi1     | N/A   | (57, 7)                                                 |
| 容  | 2  | iong5   | N/A   | (57, 8); (61, 12)                                       |
| 而  | 3  | ji5     | N/A   | (57, 9); (73, 14); (77, 16)                             |
| 婉  | 2  | uan2    | N/A   | (57, 10); (77, 14)                                      |
| 媚  | 1  | bi7     | N/A   | (57, 11)                                                |
| 絕  | 1  | zuat8   | N/A   | (57, 12)                                                |
| 倫  | 1  | lun5    | N/A   | (57, 13)                                                |
| 抱  | 1  | phau7   | N/A   | (61, 4)                                                 |
| 稍  | 1  | sau3    | N/A   | (61, 9)                                                 |
| 歡  | 1  | huann1  | N/A   | (61, 11)                                                |
| 俄  | 1  | ngoo5   | N/A   | (61, 14)                                                |
| 頃  | 1  | khing2  | N/A   | (61, 15)                                                |
| 恨  | 1  | hun7    | N/A   | (61, 16)                                                |
| 怒  | 1  | noo7    | N/A   | (61, 17)                                                |
| 平  | 1  | ping5   | N/A   | (65, 6)                                                 |
| 落  | 1  | lok8    | N/A   | (65, 8)                                                 |
| 魄  | 1  | phik4   | N/A   | (65, 9)                                                 |
| 皆  | 1  | kai1    | N/A   | (65, 11)                                                |
| 誤  | 1  | goo7    | N/A   | (65, 14)                                                |
| 天  | 2  | thian1  | N/A   | (65, 17); (85, 18)                                      |
| 寒  | 1  | kuann5  | han5  | (65, 18)                                                |
| 冬  | 1  | tang1   | tong1 | (69, 5)                                                 |
| 衣  | 1  | i1      | N/A   | (69, 6)                                                 |
| 難  | 1  | lan5    | N/A   | (69, 7)                                                 |
| 置  | 1  | ti3     | N/A   | (69, 8)                                                 |
| 貧  | 1  | pan5    | pin5  | (69, 11)                                                |
| 至  | 2  | zi3     | N/A   | (69, 12); (85, 17)                                      |
| 不  | 1  | put4    | N/A   | (69, 15)                                                |
| 焚  | 1  | hun5    | N/A   | (69, 17)                                                |
| 忿  | 1  | hun3    | N/A   | (73, 5)                                                 |
| 然  | 2  | jian5   | N/A   | (73, 6); (85, 4)                                        |
| 投  | 1  | tau5    | too5  | (73, 7)                                                 |
| 入  | 1  | jip8    | N/A   | (73, 9)                                                 |
| 吾  | 1  | ngoo5   | N/A   | (73, 12)                                                |
| 止  | 1  | zi2     | N/A   | (73, 13)                                                |
| 未  | 1  | bi7     | N/A   | (73, 15)                                                |
| 及  | 1  | kip8    | N/A   | (73, 16)                                                |
| 跌  | 1  | tiat8   | N/A   | (73, 18)                                                |
| 足  | 1  | ziok4   | N/A   | (77, 4)                                                 |
| 嘆  | 1  | than3   | N/A   | (77, 5)                                                 |
| 惋  | 1  | uan3    | N/A   | (77, 6)                                                 |
| 忽  | 1  | hut4    | N/A   | (77, 8)                                                 |
| 中  | 1  | tiong1  | N/A   | (77, 11)                                                |
| 轉  | 1  | zuan2   | N/A   | (77, 15)                                                |
| 起  | 1  | khi2    | N/A   | (77, 17)                                                |
| 肅  | 1  | sok4    | siok4 | (81, 4)                                                 |
| 拜  | 1  | pai3    | N/A   | (81, 5)                                                 |
| 揖  | 1  | ip4     | cip4  | (81, 6)                                                 |
| 別  | 1  | piat8   | N/A   | (81, 7)                                                 |
| 姿  | 1  | zu1     | N/A   | (81, 9)                                                 |
| 若  | 1  | jiok8   | N/A   | (81, 10)                                                |
| 面  | 2  | bin7    | bian7 | (81, 15); (97, 9)                                       |
| 痕  | 1  | hun5    | N/A   | (81, 17)                                                |
| 笑  | 1  | cio3    | siau3 | (85, 7)                                                 |
| 迸  | 1  | piang3  | ping3 | (85, 8)                                                 |
| 散  | 1  | san3    | N/A   | (85, 9)                                                 |
| 沒  | 1  | but8    | N/A   | (85, 11)                                                |
| 篝  | 1  | koo1    | N/A   | (85, 13)                                                |
| 焰  | 1  | iam7    | N/A   | (85, 14)                                                |
| 明  | 1  | bing5   | N/A   | (89, 4)                                                 |
| 方  | 1  | hong1   | N/A   | (89, 5)                                                 |
| 熄  | 1  | sit4    | N/A   | (89, 6)                                                 |
| 頓  | 1  | tun3    | N/A   | (97, 5)                                                 |
| 悟  | 1  | goo7    | N/A   | (97, 6)                                                 |
| 掩  | 1  | ng1     | iam2  | (97, 8)                                                 |
| 嚎  | 1  | ho5     | N/A   | (97, 10)                                                |
| 啕  | 1  | to5     | N/A   | (97, 11)                                                |
| 暖  | 1  | luan2   | N/A   | (97, 15)                                                |
| 矣  | 2  | i2      | N/A   | (97, 16); (101, 4)                                      |
| 孤  | 1  | koo1    | N/A   | (97, 18)                                                |

